---
layout: single
title: Fuzzing.
excerpt: "Es una técnica utilizada para descubrir directorios, subdominios, archivos y usuarios dentro de un sitio web o software mediante peticiones"
date: 2022-11-28
classes: wide
header:
  teaser: /assets/images/fuzz.jpg
  teaser_home_page: true
categories:
- Pentesting
- Ethical Hacking
- Reconocimiento
tags:
- Fuzzing
---

El fuzzing consiste en descubrir directorios, subdominios o archivos expuestos en un sitio web. 
<br>
A continuación se examinarán dos herramientas utilizadas en la fase de reconocimiento para aplicar fuzzing, las cuales son *gobuster* y *wfuzz*.
<br><br>

## Wfuzz.
**wfuzz -c --hc=404 -t \<threads> -w \<dictionary> \<URL>/FUZZ/**
\\
Descrubir rutas o directorios en un sitio web.
```bash
wfuzz -c --hc=404 -t 200 -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt http://192.168.55.68/FUZZ
```

- **-c** -> Parámetro para que el reporte tenga color (output del comando).
- **--hc=\<statusCode>** -> Hidecode ocultar un código de estado. Para ocultar multiples códigos estos tienen que ir separados por una coma (403,404). 
- **-t** \<threads> -> Parámetro que especifica los hilos o tareas en paralelo que quieres que se ejecuten.
- **-w** \<dictionary\> -> Especificar el diccionario a usar.
- **FUZZ** -> Palabra clave donde quieres que se aplique la sustitución del diccionario en cada petición.

<br>
Tambien puedes filtrar por ciertas cosas para que no te aparezcan en el output. Con --sl las muestras y con --hl las ocultas.
- --hl=\<number\> -> Ocultar todas las lineas que contengan el número indicado.
- --hw=\<number\> -> Ocultar todas palabras que contengan el número indicado.
- --hh=\<number\> -> Ocultar todos los caracteres que cotengan el número indicado.
<br>
<br>
<br>


Buscar cosas que estén indexadas con un ID utilizando un rango.
```
wfuzz -c -t 100 -z range,1-10000 'http://<ip-address>/id=FUZZ/'
```
- -z range -> Comando para indicar el rango que quieres abarcar.
<br>
<br>
<br>


Buscar archivos con diferente tipo de extensiones.
```
wfuzz -c --hc=404 -t 200 -w /usr/share/SecLists/Discovery/Web-Content/common.txt -z list,sh-pl-html-txt-php-git-bak-backup-pdf http://<ip-address>/cgi-bin/FUZZ.FUZ2Z
```
- -z list -> Indica que quieres añadir una lista separada por un "-".
- FUZZ -> Palabra clave donde se sustituirá el nombre del archivo.
- FUZ2Z -> Aquí es donde se sustituirán las extenciones que agregues en la lista.
<br>
<br>
<br>


Enumerar subdominios.
```
wfuzz -c --hc=404 -t 100 -w /usr/share/Seclists/Discovery/DNS/subdomains-top1million-5000.txt -H "Host: FUZZ.nunchucks.htb" https://nunchucks.htb
```
- -H -> Cabecera para indicar el dominio donde se aplicará la sustitución. 
<br>
<br>
<br>


Enumerar usuarios en un sitio web.
```
wfuzz -c -t 200 --hs"Failed login" -w /usr/share/Seclist/Username/Names/names.txt -d 'username=FUZZ&password=password' http://<ip-address>/login.php
```
- --hs -> Te permite filtrar por una cadena texto que se encuentre como respuesta al enviar una petición.<br>Lo que hace es que cada vez que nos aparezca esa cadena de texto la va a quitar para no verla en el output del comando.

- -d '\<data\>' -> Es la data que se va a tramitar por POST al momento de hacer el ataque de fuerza bruta.<br>La data la obtienes haciendo ctrl + shft + c en el sitio web, te vas a la sección red o network, das clic en el boton "sin procesar" y te mostrará la data que se esta tramitando en formato raw.
<br>
<br>
<br>


## Gobuster.
Buscar directorios dentro de un sitio web.
```
gobuster dir -u http://<ip-address>/ -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 100 --add-slash -b 403,404
```
- dir -> Parámetro para indicar que se quiere realizar una busqueda de directorios.
- -u -> Parámetro para indicar la URL del sitio web (nombre del dominio o la dirección IP).
- -w -> Opción para especificar el diccionario que se utilizará.
- -t -> Parámetro para indicar los hilos o tareas en paralelo que se ejecutarán.
- --add-slash -> Parámetro para que se agregue un "/" al final de cada petición. En algunas ocasiones es necesario poner un / para que se aplique el fuzzing.
- -b <statuscode> -> Ocultar un código de estado.(blacklist)

<br>
Tambien puedes filtrar por el código de estado 200 en lugar de ocultar los códigos de estado erroneos con el parámetro -s, pero la blacklist (-b) tiene que esta vacia
```
gobuster dir -u http://<ip-address>/ -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -t 50 --add-slash -b '' -s 200
```
<br>
<br>
<br>

Buscar archivos con diferentes extensiones.
```
gobuster dir -t 200 -w /usr/share/SecLists/Discovery/Web-Content/directory-list-2.3-medium.txt -u http://<ip-address> -x txt,php,html
```
- -u -> Indicar la URL a la cual se aplicará el ataque de fuerza bruta.
- -x -> Indicar el tipo de extensión que quieres buscar. Para indicar multiples extensiones estas van separadas por una ",".
<br>
<br>
<br>


Descubrir subdominios.
```
gobuster vhost -w /usr/share/Seclists/Discovery/DNS/subdomains-top1million-5000.txt --url https://nunchucks.htb -t 200 -k
```
- vhost -> Parámetro para indicar que se quiere hacer una busqueda de subdominios.
- --url -> Indicas la dirección IP o el dominio.
- -t -> Para indicar las tareas que quieres que se ejecuten simultaneamente.
- -k -> Aceptar el certificado del dominio en caso de que se use el protocolo HTTPS.

